import babel from '@babel/core';
import fs from 'fs-extra';

import createPrettifiedCode from './createPrettifiedCode.js';

const t = babel.types;

/**
 * Writes the given AST Program node to a file using pretty printing
 *
 * @param {string}  filePath     The file path to output the prettified code to.
 * @param {AstNode} programNode The t.program AST node to write to file.
 *
 * @return {Promise}
 */
export default async function writeAstProgramToFile(filePath, programNode) {
	if (!programNode || !t.isProgram(programNode)) {
		throw new Error('The node is not a valid Program AST node.');
	}

	const prettifiedJsCode = await createPrettifiedCode(programNode);
	await fs.outputFile(filePath, prettifiedJsCode);
}
