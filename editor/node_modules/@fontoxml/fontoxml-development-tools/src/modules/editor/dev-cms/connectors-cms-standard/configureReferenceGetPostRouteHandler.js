import referenceRepository from './referenceRepository.js';

export default function configureReferenceGetPostRouteHandler(_config) {
	return (req, res) => {
		const results = [];

		req.body.permanentIds.forEach(function (permanentId) {
			const reference = referenceRepository.get(permanentId);

			if (reference) {
				results.push({
					status: 200,
					body: reference,
				});
			} else {
				results.push({
					status: 404,
					body: null,
				});
			}
		});

		res.status(200)
			.set('content-type', 'application/json; charset=utf-8')
			.json({
				results,
			});
	};
}
