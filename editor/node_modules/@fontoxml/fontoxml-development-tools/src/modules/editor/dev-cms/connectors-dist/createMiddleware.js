import express from 'express';
import path from 'path';

import configureAuthMiddleware from './configureAuthMiddleware.js';

/**
 * Staticly serve the `dist` directory in `config.root`.
 *
 * @param {Object} config
 *
 * @return {function(req, res, next)[]}
 */
export default function createMiddleware(config) {
	return [
		...(config.distAuth ? [configureAuthMiddleware(config)] : []),
		express.static(path.join(config.root, 'dist'), {
			cacheControl: !config.cacheControlDisabled,
			maxAge: config.cacheControlMaxAge,
		}),
	];
}
