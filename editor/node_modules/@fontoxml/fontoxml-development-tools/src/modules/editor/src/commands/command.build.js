import path from 'path';

const EDITOR_BUILD_DOCUMENTATION_URL =
	'https://documentation.fontoxml.com/latest/upgrade-instructions-53f5b02b6e48';

export default (moduleRegistration, editorCommand) => {
	editorCommand
		.addCommand(
			'build',
			path.resolve(
				moduleRegistration.getPath(),
				'src',
				'commands',
				'command.build.controller.js',
			),
		)
		.setDescription(
			'Create a build of a Fonto Editor instance optimized for production usage.'
		)
		.setLongDescription(
			`This creates a build of a Fonto Editor instance which can be used for production deployment, or can be served using the development server by running "${
				moduleRegistration.getAppInfo().name
			} editor run --dist". See the documentation for help with creating a production build at ${EDITOR_BUILD_DOCUMENTATION_URL}`
		)

		.setRequiresEditorRepository()
		.setRequiresEditorVersionToMatchFdt()

		.addOption('no-mangle', 'M', 'Do not mangle the source code.')
		.addOption(
			'verbose',
			undefined,
			'Display additional build information.'
		)

		.addExample(
			`${moduleRegistration.getAppInfo().name} editor build`,
			'Create a build of the current Fonto Editor repository.'
		)
		.addExample(
			`${moduleRegistration.getAppInfo().name} editor build --no-mangle`,
			'Create a build of the current Fonto Editor repository, without mangling the application code.'
		);
};
