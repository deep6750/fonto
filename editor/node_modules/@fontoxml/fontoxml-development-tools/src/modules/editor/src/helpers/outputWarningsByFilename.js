import fs from 'fs-extra';
import path from 'path';
import stripColor from 'strip-color';

async function outputWarningsByFilename(warningsByFilename, outputPath = null) {
	for (const fileName of [...warningsByFilename.keys()].sort()) {
		for (const warning of warningsByFilename.get(fileName)) {
			const warningMessage = `${warning.message}\n\n`;
			if (outputPath) {
				await fs.appendFile(
					path.join(outputPath, 'convert-warnings.log'),
					stripColor(warningMessage)
				);
			}
			console.warn(warningMessage);
		}
	}
}

export default outputWarningsByFilename;
