import path from 'path';

import commandExtract from './src/command.extract.js';
import commandMerge from './src/command.merge.js';
import commandMessages from './src/command.messages.js';
import commandUpdate from './src/command.update.js';

export default async (moduleRegistration) => {
	moduleRegistration.registerContextInformer(path.resolve(
		moduleRegistration.getPath(),
		'src',
		'context-informer.localization.js'
	));

	const localizationCommand = moduleRegistration
		.registerCommand('localization')
		.setDescription('Tools for localizing Fonto Editor.')
		.setAsHelpCommand();

	await commandExtract(moduleRegistration, localizationCommand);
	await commandMerge(moduleRegistration, localizationCommand);
	await commandMessages(moduleRegistration, localizationCommand);
	await commandUpdate(moduleRegistration, localizationCommand);

	// Register the exports for this module.
	moduleRegistration.registerExport(
		'deduplicateMessages',
		path.resolve(
			moduleRegistration.getPath(),
			'src',
			'api',
			'deduplicateMessages.js',
		),
	);
	moduleRegistration.registerExport(
		'extractMessages',
		path.resolve(
			moduleRegistration.getPath(),
			'src',
			'api',
			'extractMessages.js',
		),
	);
};
