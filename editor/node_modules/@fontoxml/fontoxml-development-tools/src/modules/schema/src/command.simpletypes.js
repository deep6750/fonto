import path from 'path';

import createSimpleTypesTable from './api/createSimpleTypesTable.js';

export default async (moduleRegistration) => {
	const table = await createSimpleTypesTable(moduleRegistration);

	moduleRegistration
		.registerCommand(
			'simpletypes',
			path.resolve(
				moduleRegistration.getPath(),
				'src',
				'command.simpletypes.controller.js',
			),
		)
		.addAlias('list-simpletypes')
		.setDescription(
			'Output a table with information about all simple types in a schema.'
		)

		.setRequiresEditorRepository()
		.setRequiresEditorVersionToMatchFdt()

		.addOption(
			'schema',
			's',
			'In a multi-schema application, specify (a part of) the path to the source schema.json.',
			false
		)
		.addOption(table.sortOption)
		.addOption(table.columnsOption)
		.addOption(table.exportOption)

		.addExample(
			`${moduleRegistration.getAppInfo().name} simpletypes`,
			'Output information about all the simple types if the application has only one schema.json.'
		)
		.addExample(
			`${moduleRegistration.getAppInfo().name} simpletypes -s map`,
			'Output information about all the simple types if the application has one shell in a package named something with "map".'
		)
		.addExample(
			`${
				moduleRegistration.getAppInfo().name
			} simpletypes -s packages/non-standard-schema-package/src/data.json`,
			'Output information about all the simple types from a schema.json in a non-standard location.'
		);
};
