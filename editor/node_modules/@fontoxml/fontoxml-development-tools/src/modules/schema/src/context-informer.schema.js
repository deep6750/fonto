import os from 'os';

import getSchemaSummaries from './api/getSchemaSummaries.js';

export default async function schemaContextInformer (req, res) {
	res.caption('Schema locations');

	const schemaSummaries = req.fdt.editorRepository.path
		? getSchemaSummaries(req.fdt.editorRepository.path)
		: [];

	if (!schemaSummaries.length) {
		res.debug('No schemas found.');
	}

	schemaSummaries.forEach((schemaSummary) =>
		res.definition(
			schemaSummary.package,
			schemaSummary.locations && schemaSummary.locations.length
				? schemaSummary.locations.join(os.EOL)
				: 'No schema locations.'
		)
	);
}
