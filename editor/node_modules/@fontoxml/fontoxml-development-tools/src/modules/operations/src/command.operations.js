import path from 'path';

import createOperationsTable from './api/createOperationsTable.js';

export default async (moduleRegistration) => {
	moduleRegistration.registerConfiguration('operations', {
		defaultColumns: ['name', 'file', 'label'],
	});

	const table = await createOperationsTable(moduleRegistration);

	moduleRegistration
		.registerCommand(
			'operations',
			path.resolve(
				moduleRegistration.getPath(),
				'src',
				'command.operations.controller.js'
			)
		)
		.addAlias('list-operations')
		.setDescription(
			'Output a table with information about all operations defined in a Fonto Editor repository.'
		)

		.setRequiresEditorRepository()
		.setRequiresEditorVersionToMatchFdt()

		.addOption(
			new moduleRegistration.MultiOption('roots')
				.setShort('r')
				.setDescription('Root folder(s).')
		)
		.addOption(table.exportOption)
		.addOption(table.columnsOption)
		.addOption(table.sortOption)

		.addExample(
			`${moduleRegistration.getAppInfo().name} operations`,
			'Output a table with information about all operations defined in a Fonto Editor repository.'
		);
};
