import createOperationsTable from './api/createOperationsTable.js';
import getOperations from './api/getOperations.js';

export default async function operationsCommand(req, res) {
	res.caption(req.command.getLongName());

	let destroySpinner = res.spinner('Looking up operations...');

	const operations = await getOperations(
		req.fdt.editorRepository.path,
		req.options.roots.length ? req.options.roots : null,
	);

	destroySpinner();
	destroySpinner = null;
	res.break();
	const table = await createOperationsTable(
		req.command.getModuleRegistration(),
	);
	table.print(
		res,
		req.options.columns,
		operations,
		req.options.sort,
		req.options.export,
	);
}
